"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1216],{26063:function(e,t,a){a.d(t,{O:function(){return p}});var l=a(85893),o=a(11163),r=a(24556),i=a(73739),n=a(75567),d=a(52392);let s=(0,n.zo)("div",{display:"flex",gap:"$1",alignItems:"center"}),c=(0,n.zo)(r.nv,{color:"$grayscaleStone","&:hover":{cursor:"pointer",color:"$grayscaleCharcoal"}}),u=(0,n.zo)(i.Z,{color:"$grayscaleStone"}),p=e=>{let{items:t}=e,a=(0,o.useRouter)();return(0,l.jsx)(s,{children:t.map((e,o)=>o<t.length-1&&e.url?(0,l.jsxs)(s,{onClick:()=>{e.url&&a.push((0,d.C)(e.url))},children:[(0,l.jsx)(c,{size:{"@initial":200},children:e.copy}),(0,l.jsx)(u,{})]},e.copy):(0,l.jsx)(r.J3,{size:{"@initial":100},variant:"xs",children:e.copy},e.copy))})}},52392:function(e,t,a){a.d(t,{C:function(){return o},H:function(){return l}});let l=e=>{let t=e.reduce((e,t,a)=>(t.url&&e.push({"@type":"ListItem",position:a+1,item:{"@id":"https://www.warbyparker.com".concat(t.url),name:t.copy}}),e),[]);if(t.length)return{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:t}},o=e=>decodeURI(e).replace(/ /g,"-").toLocaleLowerCase()},91216:function(e,t,a){a.d(t,{K:function(){return M}});var l=a(85893),o=a(92280),r=a(67294),i=a(11163),n=a(53493),d=a(52346),s=a(76333),c=a(26053),u=a(13477),p=a(4851),v=a(19349),f=a(77050),g=a(44194),h=a(88196);let y=e=>{let{frameId:t}=e,a=(0,i.useRouter)(),o=(0,h.K)(),n=(0,v.Pf)(),d=(0,v.A7)(),{trackEvent:c,postToAnalyticsService:u}=(0,g.r)(),[y,m]=(0,r.useState)(t),[x,S]=(0,r.useState)((null==a?void 0:a.query.atc)==="true"),[b,C]=(0,r.useState)((null==a?void 0:a.query.hto)==="true"),{data:w}=(0,s.c)({frameColorId:y},{keepPreviousData:!0});return(0,r.useEffect)(()=>{m(t)},[t]),(0,r.useEffect)(()=>{let e=n("add-frame-to-cart",e=>{let{frameId:t}=e;t&&t!==y&&m(t),C(!1),S(!0),c({label:f.YX.AddFrameToCart})});return()=>d("add-frame-to-cart",e)},[n,d,S,C,c,w,o,t,y,u]),(0,l.jsx)(p.K.Root,{animated:!1,frameId:y,isOpen:x,isHomeTryOn:b,frameWidthId:o||void 0,onClose:()=>{S(!1)}})};var m=a(49851),x=a(11685),S=a(17296),b=a(78451),C=a(4655),w=a(3732),k=a(44952),j=a(76839),E=a(12095),I=a(12760),O=a(14322),$=a(53809),P=a(32296),z=a(84260),T=a(55362),R=a(26063),D=a(75567),L=a(52392);let A=(0,D.zo)("div",{marginBottom:"$space$2",marginLeft:"$space$6","@tablet":{marginLeft:"calc($space$12 + 2px)"},"@desktop":{marginLeft:"$space$12"}}),M=()=>{var e,t,a,p,D,M;let N,X;let Y=(0,i.useRouter)(),V=(0,v.Pf)(),G=(0,v.A7)(),{mutateAsync:_}=(0,j.Y8)(),[,{captureException:q}]=(0,E.T8)(),{isEnabled:B}=(0,P.g)(),F=(0,k.a)(Y.asPath,Y.query),U=Y.asPath.startsWith("/sunglasses")?o.yN.SunGlasses:o.yN.EyeGlasses;(0,I.Jg)(F);let{Track:H,trackEvent:W}=(0,g.r)({action:f.ld.ProductShop,category:U===o.yN.SunGlasses?f.$0.ProductDetailsSun:f.$0.ProductDetailsOptical},{dispatchOnMount:()=>({category:f.$0.Ecommerce,label:f.YX.ProductDetails,action:U===o.yN.SunGlasses?f.ld.ProductDetailsSun:f.ld.ProductDetailsOptical})});(0,r.useEffect)(()=>{let e=V("add-payload-to-cart",async e=>{let{payload:t}=e;W({label:f.YX.AddFrameToCart});try{await _(t),window.location.href="/cart",await new Promise(e=>{setTimeout(e,3e3)})}catch(e){q("Error adding frame to cart via add-payload-to-cart",{transactionName:"Add to cart action error",context:{data:{payload:t,frameId:F}}})}});return()=>G("add-payload-to-cart",e)},[F,V,G,W,_,q,Y]);let K=B("vto-hto-quick-add"),{data:J}=(0,c.i7)({pageValues:{pageRequest:{url:O.DP},frameId:F}},{keepPreviousData:!0}),Q=(0,s.c)({frameColorId:F},{keepPreviousData:!0}),Z=(0,h.K)(),ee=Z?null===(e=null===(t=Q.data)||void 0===t?void 0:null===(a=t.widthVariants)||void 0===a?void 0:a.find(e=>e.width.includes(Z)))||void 0===e?void 0:e.id:null===(p=Q.data)||void 0===p?void 0:null===(D=p.widthVariants)||void 0===D?void 0:null===(M=D[0])||void 0===M?void 0:M.id;(0,T.z8)({itemId:ee,itemKind:n.mz.Frame});let et=(0,C.bN)(),ea=Y.asPath.split("?")[0],el=(0,b.u8)(),eo=el&&el.split("?")[0]||"https://".concat(et?"ca":"www",".warbyparker.com").concat(ea);if(Q.isSuccess){let e=Q.data,t=(0,d.n)(e);N={title:"".concat(t),description:"".concat(t,". ").concat(e.description),url:eo,image:e.images.front},X={"@context":"https://schema.org","@type":"Product","@id":eo,name:e.name,image:(null==e?void 0:e.images)&&Object.values(null==e?void 0:e.images)[0],description:e.description,brand:{"@type":"Brand","@id":"Brand",name:"Warby Parker"},offers:{"@type":"Offer","@id":"Offer",url:eo,priceCurrency:et?"CAD":"USD",price:e.price,availability:e.isAvailable?"InStock":"OutOfStock",itemCondition:"https://schema.org/NewCondition"}}}let er=null==J?void 0:J.config.breadcrumbs;return(0,l.jsx)(z.T,{page:J,children:(0,l.jsxs)(H,{children:[(0,l.jsx)(S.d,{config:null==J?void 0:J.config,defaultMeta:N,productMeta:null!=X?X:void 0,breadcrumbsMeta:er?(0,L.H)(er):void 0}),(0,l.jsxs)(w.h2,{widgetData:null==J?void 0:J.widgets,children:[er?(0,l.jsx)(A,{children:(0,l.jsx)(R.O,{items:er})}):null,null==J?void 0:J.widgets.map(u.G)]}),(0,l.jsx)(y,{frameId:F}),(0,l.jsx)(m.G,{}),(0,l.jsx)($.W,{}),(0,l.jsx)(x.U,{showVtoHtoQuickAdd:K})]})})}},53809:function(e,t,a){a.d(t,{W:function(){return q}});var l=a(85893),o=a(67294),r=a(91296),i=a.n(r),n=a(75047),d=a(40775),s=a(80650),c=a(19349),u=a(42243),p=a(44194),v=a(77050),f=a(78553),g=a(60965),h=a(24556),y=a(96235),m=a(75567),x=a(21530),S=a(36901),b=a(60652),C=a(63752),w=a(89839),k=a(33765);let j=(0,m.zo)("li",{display:"flex",flexDirection:"column",alignItems:"stretch",padding:"$4",gap:"$4",border:"1px solid $colors$grayscaleSilver",borderRadius:"$space$3",alignSelf:"stretch",flexGrow:0,"@tablet":{padding:"$6",gap:"$6"},"@desktop":{padding:"$6",gap:"$6"}}),E=(0,m.zo)("div",{display:"flex",flexDirection:"column",gap:"$1"}),I=(0,m.zo)(h.J3,{display:"flex",justifyContent:"space-between",gap:"$3"}),O=(0,m.zo)("span",{display:"inline-flex",flex:"0 0 $space$16",alignItems:"flex-start",justifyContent:"flex-end"}),$=(0,m.zo)("span",{color:"$grayscaleStone",variants:{isOpen:{true:{color:"$supportGreen"}}}}),P=(0,m.zo)("span",{color:"$grayscaleStone"}),z=(0,m.zo)("footer",{display:"flex",flexDirection:"column",gap:"$3","@tablet":{flexDirection:"row",flexWrap:"wrap"},"@desktop":{flexDirection:"row",flexWrap:"wrap"}}),T=(0,m.zo)(b.Z,{flex:"1 0 0%","@tablet":{maxWidth:"50%"},"@desktop":{flex:"0 0 180px"}}),R=(0,m.zo)(C.h,{alignSelf:"flex-start"}),D=(0,m.zo)(h.nv,{color:"$grayscaleStone",flex:"0 0 100%"}),L=e=>{let{data:{name:t,distanceMilesDisplay:a,offersEyeExams:r,status:i,mapUrl:n,addressDisplay:d,id:s,externalId:c},onBookEyeExamClick:u,onGetDirectionsClick:p,onViewStoreDetailsClick:v}=e,{opens:f,closes:g}=(0,o.useMemo)(()=>{var e,t;return{opens:(0,k.m)(null==i?void 0:null===(e=i.businessHours)||void 0===e?void 0:e.startTime),closes:(0,k.m)(null==i?void 0:null===(t=i.businessHours)||void 0===t?void 0:t.endTime)}},[i]),{bookAnExamHref:y,viewDetailsHref:m,getDirectionsHref:x}=(0,o.useMemo)(()=>({bookAnExamHref:(0,w.ko)(c),viewDetailsHref:(0,w.oF)(c),getDirectionsHref:n||(0,w.gl)(d)}),[c,n,d]),S=(0,o.useCallback)(()=>{u(s)},[s,u]),b=(0,o.useCallback)(()=>{p(s)},[s,p]),C=(0,o.useCallback)(()=>{v(s)},[s,v]);return(0,l.jsxs)(j,{children:[(0,l.jsxs)(E,{children:[(0,l.jsxs)(I,{variant:"lg",tag:"p",children:[(0,l.jsx)("span",{children:t}),void 0!==a&&(0,l.jsxs)(O,{children:[a," mi"]})]}),i&&(0,l.jsxs)(h.gi,{variant:"md",tag:"p",children:[(0,l.jsx)($,{isOpen:i.isOpen,children:i.isOpen?"Open":"Closed"})," \xb7 ",(0,l.jsx)(P,{children:i.isOpen?"Closes at ".concat(g):"Opens at ".concat(f)})]}),(0,l.jsx)(R,{href:m,onClick:C,children:(0,l.jsx)(h.J3,{variant:"md",children:"View store details"})})]}),(0,l.jsxs)(z,{children:[r?(0,l.jsx)(T,{color:"clear",href:y,size:"large",onClick:S,children:"Book an eye exam"}):(0,l.jsx)(D,{tag:"p",variant:"md",children:"Eye exams not available"}),(0,l.jsx)(T,{color:"clear",href:x,target:"_blank",size:"large",onClick:b,children:"Get directions"})]})]})},A=(0,m.zo)(S.k,{marginTop:"$18",gap:"$6"}),M=(0,m.zo)("section",{display:"flex",flexDirection:"column",flex:"1 1 auto",gap:"$6","@desktop":{flex:"0 0 352px"}}),N=(0,m.zo)("section",{display:"flex",flexDirection:"column",alignItems:"stretch",flex:"1 1 auto","@desktop":{flex:"0 0 634px"}}),X=(0,m.zo)("div",{display:"flex",flexDirection:"column",gap:"$3",width:"100%"}),Y=e=>{let{addressTerm:t,addressOptions:a,addressOptionsLoading:r,addressOptionsLoadingError:i,stores:n,storesLoading:d,storesLoadingError:s,onAddressSelect:c,onAddressTermChange:u,onAddressOptionsLoadingRetry:p,onBookEyeExamClick:v,onGetDirectionsClick:f,onPreciseLocationSelect:m,onViewStoreDetailsClick:b,onStoresLoadingErrorRetry:C}=e,w=(0,o.useMemo)(()=>a.map(e=>({firstLine:e.fullAddress,payload:e})),[a]);return(0,l.jsxs)(A,{children:[(0,l.jsx)(S.M,{columns:{default:[1,4],tablet:[1,8],desktop:[1,4]},children:(0,l.jsxs)(M,{children:[(0,l.jsx)(h.h4,{variant:"md",tag:"h1",children:"Find a store"}),(0,l.jsx)(g.hQ,{choices:w,label:"Search by zip code or city",searchTerm:t,textEmpty:"No matches found.",handleSelectChoice:e=>c(null==e?void 0:e.payload),handleChange:e=>u(null!=e?e:""),handleReset:()=>u(""),handleLoadingRetry:p,emptyTermChoice:(0,l.jsx)(g.Th,{onClick:m}),loading:r,loadingError:i?"Unable to load locations":"",openInOverlay:!0})]})}),(0,l.jsx)(S.M,{columns:{default:[1,4],tablet:[1,8],desktop:[6,12]},children:(0,l.jsx)(N,{children:(0,l.jsx)(y.f,{isLoading:d,children:s?(0,l.jsx)(x.M,{isLoading:d,errorCopy:"We couldnâ€™t load the results. Want to try again?",buttonCopy:"Try again",onClick:C}):(0,l.jsx)(X,{children:n.map(e=>(0,l.jsx)(L,{data:e,onBookEyeExamClick:v,onGetDirectionsClick:f,onViewStoreDetailsClick:b},e.id))})})})})]})};var V=a(61826);let G=(0,m.zo)("div",{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}),_=()=>(0,l.jsx)(G,{children:(0,l.jsx)(V.$,{size:40})}),q=()=>{var e;let[t,a]=(0,o.useState)(!1),[r,g]=(0,o.useState)(!0),[h,y]=(0,o.useState)(""),[m,x]=(0,o.useState)(),[S,b]=(0,o.useState)(!1),{debouncedValue:C}=(0,u.N)(h,200),{Track:w,trackEvent:k}=(0,p.r)({category:v.$0.StoreLocatorModal});(0,c.SN)("open-find-in-store-overlay",e=>{y(e.zipCode),g(!0),a(!0),k({action:v.ld.Click,label:v.YX.Open})},[]);let{data:j,isFetching:E,isError:I,refetch:O}=(0,n.AX)(C,{enabled:t&&!!C&&!S,retry:!1}),{data:$,isFetching:P,isError:z,refetch:T}=(0,n.W1)(null!==(e=null==m?void 0:m.id)&&void 0!==e?e:"",{enabled:t&&!!m,retry:!1}),{data:R,isFetching:D,error:L,refetch:A}=(0,n.yA)({enabled:t&&S,retry:!1}),M=S?R:$,N=S&&!!L,{data:X,isFetching:V,isError:G,refetch:q}=(0,d.T)({size:20,latitude:null==M?void 0:M.latitude,longitude:null==M?void 0:M.longitude,useMyLocation:N,facilityTypes:[f.$n.Retail]},{enabled:t&&(!!M||N),retry:!1,keepPreviousData:!0});(0,o.useEffect)(()=>{X&&k({action:v.ld.Select,label:v.YX.StoreLocation})},[X]),(0,o.useEffect)(()=>{r&&((null==j?void 0:j.length)?x(j[0]):(null==j?void 0:j.length)===0&&(b(!0),g(!1)),(j&&$&&X||I||z||G)&&g(!1))},[r,j,$,X,I,z,G]),(0,o.useEffect)(()=>{S&&R&&(y(R.address),x({id:R.id,fullAddress:R.address,primaryAddress:R.address,secondaryAddress:""}))},[S,R]);let B=(0,o.useMemo)(()=>h?S&&m?[m]:null!=j?j:[]:[],[h,j,S,m]),F=(0,o.useCallback)(i()(()=>{k({action:v.ld.Input,label:v.YX.StoreSearch})},200),[k]),U=e=>{y(e),b(!1),F()},H=()=>{b(!0),L&&A()},W=()=>{k({action:v.ld.Click,label:v.YX.Close}),a(!1),y(""),b(!1)},K=e=>{k({action:v.ld.Click,label:v.YX.StoreBookEyeExamStoreID.replace("%storeId%",e)})},J=e=>{k({action:v.ld.Click,label:v.YX.StoreGetDirectionsStoreID.replace("%storeId%",e)})},Q=e=>{k({action:v.ld.Click,label:v.YX.StoreViewDetailsStoreID.replace("%storeId%",e)})},Z=()=>{O()},ee=async()=>{S||$||await T(),S&&!R&&await A(),await q()};return(0,l.jsx)(w,{children:(0,l.jsx)(s.a.Root,{isOpen:t,onOpenChange:W,children:(0,l.jsxs)(s.a.Content,{children:[(0,l.jsx)(s.a.CloseButton,{}),r?(0,l.jsx)(_,{}):(0,l.jsx)(Y,{addressTerm:h,addressOptions:B,addressOptionsLoading:E,addressOptionsLoadingError:I,storesLoadingError:z||G,stores:null!=X?X:[],storesLoading:!!h&&(P||D||V),onAddressSelect:x,onAddressOptionsLoadingRetry:Z,onAddressTermChange:U,onBookEyeExamClick:K,onStoresLoadingErrorRetry:ee,onGetDirectionsClick:J,onPreciseLocationSelect:H,onViewStoreDetailsClick:Q})]})})})}},4851:function(e,t,a){a.d(t,{K:function(){return A}});var l=a(85893),o=a(11163),r=a(67294),i=a(90473),n=a(89056),d=a(53493),s=a(76839),c=a(26053),u=a(32296),p=a(47253),v=a(14322),f=a(19349),g=a(44194),h=a(64487),y=a(4202),m=a(88196),x=a(76333),S=a(4655),b=a(91504);let C=e=>{let{cartState:t,frameId:a}=e,{trackMixpanelEvent:l}=(0,g.r)(),{data:o,isSuccess:i}=(0,x.c)({frameColorId:a},{keepPreviousData:!0}),n=(0,m.K)(),d=(0,S.bN)(),s=(0,f.Pf)(),c=(0,f.A7)(),[u,p]=(0,r.useState)({});(0,r.useEffect)(()=>{let e=s("atc-reset",()=>{p({})});return()=>{p({}),c("atc-reset",e)}},[s,c]);let v=(0,r.useCallback)(()=>{try{if(i&&o){var e,a,r;let{price:i}=o,s=(0,b.M)({framesData:[o],selectedWidth:n||void 0,pcProductId:null==t?void 0:null===(e=t.activeReviewNode)||void 0===e?void 0:null===(a=e.cartItems)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.pcProductId,atcItemValues:{...u}});l({event:y.R.ProductAdded,ecommerce:{currency:d?"CAD":"USD",value:Number(i),items:s}})}}catch(e){h.Tb("Error tracking ATC review Mixpanel event",e instanceof Error?{contexts:{error:{message:null==e?void 0:e.message,stack:null==e?void 0:e.stack}}}:void 0)}},[i,n,d,t,o,u,l]);return{trackAtcReviewAddToCart:v}};var w=a(75567),k=a(77050),j=a(13477),E=a(46072),I=a(55362),O=a(85773),$=a(74843);let P={start:{opacity:0},enter:{opacity:[0,1]},leave:{opacity:[1,0]}},z=(0,w.zo)(n.VY,{backgroundColor:"white",position:"fixed",top:"0",left:"0",height:"100%",width:"100%",zIndex:"$appOverlay","&:focus":{outline:"none"}}),T=(0,w.zo)(n.aV,{overflow:"hidden"}),R=(0,w.zo)("div",{height:"100%",zIndex:"$appOverlay"}),D=()=>{window.location.assign("/cart")},L=e=>!!e&&!!e.cart&&1===e.cart.htoQuantityRemaining,A={Root:function(e){var t,a;let{animated:h=!0,children:y,defaultIsOpen:x=!1,isOpen:S,frameId:b,isHomeTryOn:w=!1,frameWidthId:A,onClose:M,onOpenChanged:N}=e,X=(0,f.Pf)(),Y=(0,f.A7)(),V=(0,s.Y8)(),{data:G,refetch:_}=(0,p.pX)(),{Track:q,trackEvent:B,postToAnalyticsService:F}=(0,g.r)({action:k.ld.LensSelectionClick}),U=null!=S?S:x,[H,W]=(0,r.useState)(),K=(0,o.useRouter)(),{isEnabled:J}=(0,u.g)(),Q=(0,m.K)();(0,r.useEffect)(()=>{if(S||U||x){var e;F({type:"atc-started",itemId:b,itemKind:d.mz.Frame,isVtoModule:(null===(e=K.asPath)||void 0===e?void 0:e.includes("vto"))||!1,stepSelection:Q})}},[U,x,S,K,F,b,Q]);let Z="string"==typeof K.query.addedVia?K.query.addedVia:"pdp",ee=(0,r.useMemo)(()=>(0,E.P)(w?k.YX.HtoAddedViaPage:k.YX.PurchaseAddedViaPage,{page:Z}),[w,Z]),et=(0,c.i7)({pageValues:{frameId:b,ishto:w,frameWidthId:A,pageRequest:{url:v.LT}}},{enabled:J("fetch-atc-on-open")?S&&!!A:!!A}),[ea,el]=(0,r.useReducer)(O.I6,et.data?{...O.E3,activeNode:(0,$.X_)(et.data,{cart:null==G?void 0:G.cart,disableOptionsInCart:w})}:O.E3,O.S1),{trackAtcReviewAddToCart:eo}=C({cartState:ea,frameId:b}),er=(0,I.cL)(),ei=(0,I.uq)(b);(0,r.useEffect)(()=>{if(el({type:O.a3.RESET}),W(void 0),et.data){let e=(0,$.X_)(et.data,{cart:null==G?void 0:G.cart,disableOptionsInCart:w});e&&el({type:O.a3.SET_STEP,payload:e})}},[et.data,U]);let{activeNode:en,activeGenericNode:ed,activeReviewNode:es}=ea,ec=null==ed?void 0:null===(t=ed.skipStep)||void 0===t?void 0:t.nextNode,[eu,ep]=(0,r.useState)({});(0,r.useEffect)(()=>{H&&W(void 0)},[b]);let ev=e=>{if(W(e),null==ed?void 0:ed.widget){let{id:t,config:a}=ed.widget;if("two-groups-swatches"===a.pillsLayout){let a=e.uniqueId;ep(e=>({...e,[t]:{...(null==e?void 0:e[t])||{},activePillId:a}}))}}},ef=e=>{ei(e,en)},eg=e=>{var t;if("atc-tab-generic"===e.type&&!e.pills.length&&(null===(t=e.skipStep)||void 0===t?void 0:t.nextNode)){W(void 0),el({type:O.a3.SET_STEP,payload:e.skipStep.nextNode});return}if("atc-tab-review"===e.type&&e.skipReview&&e.cartItems){el({type:O.a3.SUBMIT}),B({label:k.YX.AddToCart,target:w?k.no.VariantHto:k.no.SelectLenses}),V.mutate({newItems:e.cartItems,addedVia:Z},{onError:()=>{W(void 0),el({type:O.a3.SUBMIT_ERROR})},onSuccess:async()=>{if(B({category:k.$0.Ecommerce,action:k.ld.ProductAdded,label:ee}),eo(),er(e),w&&L(G))D();else if(w&&M){if(W(void 0),et.data){let{data:e}=await _(),t=(0,$.X_)(et.data,{cart:null==e?void 0:e.cart,disableOptionsInCart:w});t&&el({type:O.a3.HTO_REFRESH,payload:t})}M()}else D()}});return}W(void 0),el({type:O.a3.SET_STEP,payload:e})},eh=(0,r.useCallback)(()=>{W(void 0),B({label:"".concat(k.$0.LensSelection,"-").concat(k.YX.Back)});let e=null==en?void 0:en.previousNode;return e?(null==e?void 0:e.type)==="atc-tab-generic"&&!e.pills.length&&e.previousNode?el({type:O.a3.SET_STEP,payload:e.previousNode}):el({type:O.a3.SET_STEP,payload:e}):void 0},[en,B]),ey=e=>{if(e||B({label:"".concat(k.$0.LensSelection,"-").concat(k.YX.Close)}),!e&&M){M();return}if(e&&et.data){let e=(0,$.X_)(et.data,{cart:null==G?void 0:G.cart,disableOptionsInCart:w});e&&el({type:O.a3.SET_STEP,payload:e})}N&&N(e)};(0,r.useEffect)(()=>{let e=X("atc-review-add-to-cart",()=>{es&&es.cartItems&&(el({type:O.a3.SUBMIT}),B({label:k.YX.AddToCart,target:w?k.no.VariantHto:k.no.SelectLenses}),V.mutate({newItems:es.cartItems,addedVia:Z},{onError:()=>el({type:O.a3.SUBMIT_ERROR}),onSuccess:()=>{eo(),B({category:k.$0.Ecommerce,action:k.ld.ProductAdded,label:ee}),er(es),D()}}))});return()=>Y("atc-review-add-to-cart",e)},[en,w,ee,X,B,Y]),(0,r.useEffect)(()=>{let e=X("atc-reset",()=>{if(et.data){B({label:k.YX.EditSelections});let a=(0,$.X_)(et.data,{cart:null==G?void 0:G.cart,disableOptionsInCart:w});if(a){var e,t;let l=a;"atc-tab-generic"===a.type&&(null===(e=a.skipStep)||void 0===e?void 0:e.nextNode)&&(null===(t=a.skipStep)||void 0===t?void 0:t.skipOnReset)&&(l=a.skipStep.nextNode),el({type:O.a3.SET_STEP,payload:l})}}});return()=>Y("atc-reset",e)},[et.data,w,null==G?void 0:G.cart,X,B,Y]),(0,r.useEffect)(()=>{let e=X("atc-skip",()=>{ec&&eg(ec)});return()=>Y("atc-skip",e)},[ec,X,Y]),(0,r.useEffect)(()=>{let e=X("atc-step-deselect",()=>{W(void 0)});return()=>{Y("atc-step-deselect",e)}},[X,Y]),(0,r.useEffect)(()=>{let e=X("atc-next-selected",()=>{H&&((null==ed?void 0:ed.widget.config.pillsLayout)==="two-groups-swatches"&&B({label:k.YX.ContinueLensColor}),eg(null==H?void 0:H.nextNode))});return()=>Y("atc-next-selected",e)},[H,ed,X,Y,B]),(0,r.useEffect)(()=>{var e,t;let a=(null===(e=et.data)||void 0===e?void 0:null===(t=e.widgets)||void 0===t?void 0:t.filter(e=>{let{type:t}=e;return"atc-tab-generic"===t}))||[],l=a.reduce((e,t)=>{let{config:a,id:l}=t,{firstGroup:o,pills:r,pillsLayout:i}=a;if("two-groups-swatches"===i){var n;let t=null===(n=null==r?void 0:r.find(e=>{let{group:t}=e;return t===o}))||void 0===n?void 0:n.uniqueId;return{...e,[l]:{activeGroup:o,activePillId:t}}}return e},{});ep(l)},[null===(a=et.data)||void 0===a?void 0:a.widgets]),(0,r.useEffect)(()=>{if(!ed||(null==ed?void 0:ed.widget.config.pillsLayout)!=="two-groups-swatches")return()=>{};let{widget:e,pills:t}=ed,{id:a}=e,{activePillId:l}=eu[a],o=null==t?void 0:t.find(e=>{let{uniqueId:t}=e;return l&&t===l}),r=null!=o?o:t[0];W(r||t[0]),ep(e=>({...e,[a]:{...e[a]||{},activeGroup:null==r?void 0:r.group,activePillId:null==r?void 0:r.uniqueId}}));let i=X("atc-next-group",e=>{let{groupId:t}=e;ep(e=>({...e,[a]:{...(null==e?void 0:e[a])||{},activeGroup:t}}))});return()=>{Y("atc-next-group",i)}},[X,Y,ed,ep]);let em=(0,r.useMemo)(()=>{if(null==ed?void 0:ed.widget){let{id:e}=ed.widget;return eu[e]||{}}return{}},[ed,eu]);return(0,l.jsx)(q,{children:(0,l.jsxs)(n.fC,{defaultOpen:x,open:U,onOpenChange:ey,children:[(0,l.jsx)(O.Mo.Provider,{value:{...ea,onPillSelected:ev,onPillSelectedEvent:ef,onPrevClick:eh,onStepSelected:eg,twoGroupsSwatchesStatus:em,isOpen:U,selectedPill:H},children:(0,l.jsx)(i.r,{show:U,start:h?P.start:{},enter:h?P.enter:{},leave:h?P.leave:{},children:e=>{let{opacity:t}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(T,{forceMount:!0}),(0,l.jsx)(z,{forceMount:!0,css:{opacity:t},children:en&&(0,j.G)(en.widget)})]})}})}),(0,l.jsx)(R,{css:{display:U?"block":"none"},children:y})]})})},Trigger:n.xz}},49851:function(e,t,a){a.d(t,{G:function(){return E}});var l=a(85893),o=a(92280),r=a(67294),i=a(11163),n=a(26053),d=a(80650),s=a(61826),c=a(75567),u=a(19349),p=a(13477),v=a(77050),f=a(44194),g=a(21530),h=a(13668),y=a(44952),m=a(21540),x=a(79153),S=a(77605),b=a(769),C=a(26770),w=a(46533);let k=e=>{let{children:t,modal:a}=e,o=(0,r.useMemo)(()=>{if(!a)return;let{widgets:e,preload:t,warnings:l,...o}=a||{};return o},[a]);return(0,C.G1)(a),(0,l.jsx)(w.R.Provider,{value:o,children:t})},j=(0,c.zo)("div",{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}),E=()=>{var e,t;let{trackEvent:a}=(0,f.r)(),[c,C]=(0,r.useState)(),[w,E]=(0,r.useState)(null),[I,O]=(0,r.useState)(!1),{asPath:$,query:P}=(0,i.useRouter)(),{type:z}=(0,m.q)(),T=z===o.GV.FramesPdp?(0,y.a)($,P):void 0,R=(0,r.useCallback)(e=>t=>{let{frameId:l=T,pageUrl:o}=t;"open-frame-overlay"===e&&a({action:v.ld.Click,label:"".concat(v.YX.OpenFrameOverlay," ").concat(null!=o?o:"")}),C(e),E({frameId:l,pageUrl:o})},[a,T]);(0,u.SN)("open-overlay",R("open-overlay"),[]),(0,u.SN)("open-frame-overlay",R("open-frame-overlay"),[]),(0,u.SN)("wizard-close-modal",()=>{C(void 0)},[]);let{isLoading:D,isSuccess:L,isError:A,isRefetching:M,data:N,refetch:X}=(0,n.i7)({pageValues:{pageRequest:{url:null!==(e=null==w?void 0:w.pageUrl)&&void 0!==e?e:""},frameId:null!==(t=null==w?void 0:w.frameId)&&void 0!==t?t:""}},{enabled:!!w,onError:()=>{O(!0)},onSuccess:()=>{O(!1)}}),Y=e=>{if(!e&&(I&&E(null),O(!1),"open-frame-overlay"===c)){var t;a({action:v.ld.Close,label:"".concat(v.YX.OpenFrameOverlay," ").concat(null!==(t=null==w?void 0:w.pageUrl)&&void 0!==t?t:"")})}C(void 0)},V=!!c,G=(0,r.useMemo)(()=>({isOverlayOpen:V}),[V]);return(0,l.jsx)(k,{modal:N,children:(0,l.jsx)(h.A.Provider,{value:G,children:(0,l.jsx)(d.a.Root,{isOpen:V,onOpenChange:Y,children:(0,l.jsxs)(d.a.Content,{children:[(0,l.jsx)(d.a.CloseButton,{}),!I&&(D||M)&&(0,l.jsx)(j,{children:(0,l.jsx)(s.$,{size:40})}),(()=>{var e;if(!L)return null;if(null==w?void 0:null===(e=w.pageUrl)||void 0===e?void 0:e.includes("quiz")){let e=null==w?void 0:w.pageUrl.split("quiz")[1];return(0,l.jsx)(S.L,{wizardId:e,kind:b.Ig.Quiz,data:N,closable:!1,defaultReturnUrl:$,children:(0,l.jsx)(x.e,{})})}return null==N?void 0:N.widgets.map(p.G)})(),(A||I)&&(0,l.jsx)(j,{children:(0,l.jsx)(g.M,{isLoading:D||M,errorCopy:"Want to try again?",buttonCopy:"Reload",onClick:X})})]})})})})}},88196:function(e,t,a){a.d(t,{K:function(){return s},r:function(){return n}});var l=a(92280),o=a(67294),r=a(11163);let i=Object.values(l.BM),n=e=>-1!==i.findIndex(t=>t===e),d=e=>"string"==typeof e.w&&n(e.w)?e.w:null,s=()=>{let e=(0,r.useRouter)(),t=(0,o.useMemo)(()=>d(e.query),[e.query]);return t}},52346:function(e,t,a){a.d(t,{k:function(){return r},n:function(){return o}});let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},o=e=>{let{bridgeFit:t,color:a,name:o,kind:r}=e;return"".concat(o).concat("lowBridge"===t?" Low Bridge Fit ":" ").concat(l(r)," in ").concat(a)},r=e=>{if(e){let{bridgeFit:t,kind:a,color:l,name:r}=e;return o({bridgeFit:t,kind:a,color:l,name:r})}return null}}}]);